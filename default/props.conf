#####
## todo..
## action in firewall
#####


[routeros]

##
pulldown_type = true
category = Network & Security
description = Mikrotik RouterOS

SHOULD_LINEMERGE=false
NO_BINARY_CHECK=true
CHARSET=UTF-8
MAX_TIMESTAMP_LOOKAHEAD=20
disabled=false

EXTRACT-ips = firewall,(\S+)\s(\S+)\sin:(?<src_interface>\S+)\sout:(?<dest_interface>).+,\sproto\s(?<protocol>\S+)\,\s(?<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):(?<src_port>\d+)->(?<dest_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):(?<dest_port>\d+)
EXTRACT-dns_query = dns\s(?<vendor_message_type>query\sfrom)\s(?<src>[^\:]+)\:\s#(?<transaction_id>\S+)\s(?<query>\S+)\s(?<record_type>\S+)
EXTRACT-dns_response = dns\s(?<vendor_message_type>done\squery)\:\s#(?<transaction_id>\S+)\s(?<query>\S+)\s(?<answer>\S+)

FIELDALIAS-routeros_dvc = host AS dvc
FIELDALIAS-routeros_dvc_host = host AS dvc_host

FIELDALIAS-routeros_src = src AS src_ip
FIELDALIAS-routeros_dest = dest AS dest_ip

EVAL-vendor_product = "Mikrotik RouterOS"

REPORT-dhcp = routeros_dhcp_assign_extract

LOOKUP-1_message_type_lookup = routeros_message_type_lookup vendor_message_type OUTPUT message_type